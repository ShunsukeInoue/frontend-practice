Difyでは設定できるが、S3 Vectors単体では設定できない（＝アプリ側実装が必要）パラメータ

1) 検索モード（Vector / Full-text / Hybrid）

Difyは Vector Search / Full-Text Search / Hybrid Search を選べます。  ￼
S3 Vectors の QueryVectors は ベクタ検索（ANN）専用で、全文検索やハイブリッド検索自体は提供しません。  ￼
→ S3でDify相当をやるなら、全文検索は OpenSearch 等を別で持ち、結果をマージする必要があります。

2) Hybridの「Weight settings」（キーワード×セマンティックの重み）

DifyのHybridは キーワード優先度とセマンティック優先度の重みを調整できます。  ￼
S3 Vectorsは重み付けという概念はなく、topK件の近傍を返すだけです。  ￼
→ アプリ側で「全文検索スコア」と「ベクタ距離」を正規化して重み付け合算、などが必要。

3) Rerank Model（再ランキングモデルの有効化）

Difyは検索後に Rerankモデルで並び替えを入れられます（Vector/Full-text/Hybrid いずれでも）。  ￼
S3 Vectorsは returnDistance/returnMetadata等は返せますが、再ランキング処理そのものは持ちません。  ￼
→ cross-encoder系（Cohere/Jina系rerank等）をアプリで呼ぶ構成。

4) Score Threshold（類似度しきい値）

Difyは **Score Threshold（最低類似度）**を設定できます。  ￼
S3 Vectors QueryVectors のリクエスト項目は filter / topK / returnDistance / returnMetadata等で、しきい値パラメータはありません（必要なら返ってきた距離を見てアプリ側で足切り）。  ￼

5) チャンク設計（Chunk settings / Chunk mode）

Difyは取り込み時にチャンク化を設定でき、さらに General / Parent-childのようなチャンクモードも持ちます。  ￼
S3 Vectorsは **「ベクタを保存して検索する」**だけなので、チャンク分割・親子チャンク構造などは範囲外です。  ￼

6) 取得戦略（例：Multi-path retrieval など）

Difyは（アプリ/フロー側で）知識取得ノードにおいて 複数知識ベースや戦略の概念を持ち、検索戦略を調整できます。  ￼
S3 Vectorsは 単一インデックスに対してクエリするAPIなので、このあたりもアプリ側のオーケストレーションになります。  ￼

⸻

逆に「S3 Vectorsでも設定できる」ので差分じゃないもの
	•	topK（返す件数）：DifyにもS3にもある  ￼
	•	メタデータフィルタ：DifyにもS3にもある（ただし仕組みや運用UXは別物）  ￼

⸻

使い分けの実務イメージ（S3でDify相当を寄せるなら）
	•	Difyの Hybrid/Weight → 「全文検索エンジン + S3 Vectors」を併用してスコア融合
	•	Rerank/Threshold → 取得後にアプリ側で rerank & 閾値フィルタ
	•	Chunk/Parent-child → 取り込みパイプラインで実装（親ID/子IDをメタデータで管理して再構成）
